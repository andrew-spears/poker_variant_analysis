(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29972,        879]
NotebookOptionsPosition[     29302,        860]
NotebookOutlinePosition[     29697,        876]
CellTagsIndexPosition[     29654,        873]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"-", "Modular"}]}], " ", "Game", " ", 
    RowBox[{"Definition", ":", 
     RowBox[{
      RowBox[{"CP", "--"}], "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "bluffThresholdCP", ",", "valueThresholdCP", ",", "callThresholdCP", ",",
       "bluffSizeCP", ",", "valueSizeCP"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"bluffThresholdCP", "[", "B_", "]"}], ":=", 
     RowBox[{"2", " ", 
      RowBox[{"B", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "B"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", 
           RowBox[{"2", " ", "B"}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"valueThresholdCP", "[", "B_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"8", " ", "B"}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"B", "^", "2"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "B"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"2", " ", "B"}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"callThresholdCP", "[", "s_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "s", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", "s"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "s"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"2", " ", "s"}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"bluffSizeCP", "[", 
      RowBox[{"B_", ",", "x_"}], "]"}], ":=", "B"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"valueSizeCP", "[", 
      RowBox[{"B_", ",", "x_"}], "]"}], ":=", "B"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "Symbolic"}]}], " ", "Payoff", " ", 
      RowBox[{"Function", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "payoffCP", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffCP", "[", 
      RowBox[{"B_", ",", "x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{
           RowBox[{"x", "<=", 
            RowBox[{"bluffThresholdCP", "[", "B", "]"}]}], "&&", 
           RowBox[{"y", "<", 
            RowBox[{"callThresholdCP", "[", 
             RowBox[{"bluffSizeCP", "[", 
              RowBox[{"B", ",", "x"}], "]"}], "]"}]}]}]}], "}"}], ",", 
        RowBox[{"(*", "Bluff_Fold", "*)"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"bluffSizeCP", "[", 
             RowBox[{"B", ",", "x"}], "]"}]}], "-", "0.5"}], ",", 
          RowBox[{
           RowBox[{"x", "<=", 
            RowBox[{"bluffThresholdCP", "[", "B", "]"}]}], "&&", 
           RowBox[{"y", ">=", 
            RowBox[{"callThresholdCP", "[", 
             RowBox[{"bluffSizeCP", "[", 
              RowBox[{"B", ",", "x"}], "]"}], "]"}]}]}]}], "}"}], ",", 
        RowBox[{"(*", "Bluff_Called", "*)"}], 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{
           RowBox[{"x", ">=", 
            RowBox[{"valueThresholdCP", "[", "B", "]"}]}], "&&", 
           RowBox[{"y", "<", 
            RowBox[{"callThresholdCP", "[", 
             RowBox[{"valueSizeCP", "[", 
              RowBox[{"B", ",", "x"}], "]"}], "]"}]}]}]}], "}"}], ",", 
        RowBox[{"(*", "Value_Fold", "*)"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"valueSizeCP", "[", 
             RowBox[{"B", ",", "x"}], "]"}]}], "-", "0.5"}], ",", 
          RowBox[{
           RowBox[{"x", ">=", 
            RowBox[{"valueThresholdCP", "[", "B", "]"}]}], "&&", 
           RowBox[{"y", ">=", 
            RowBox[{"callThresholdCP", "[", 
             RowBox[{"valueSizeCP", "[", 
              RowBox[{"B", ",", "x"}], "]"}], "]"}]}], "&&", 
           RowBox[{"y", ">", "x"}]}]}], "}"}], ",", 
        RowBox[{"(*", "Value_Loses", "*)"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"valueSizeCP", "[", 
            RowBox[{"B", ",", "x"}], "]"}], "+", "0.5"}], ",", 
          RowBox[{
           RowBox[{"x", ">=", 
            RowBox[{"valueThresholdCP", "[", "B", "]"}]}], "&&", 
           RowBox[{"y", ">=", 
            RowBox[{"callThresholdCP", "[", 
             RowBox[{"valueSizeCP", "[", 
              RowBox[{"B", ",", "x"}], "]"}], "]"}]}], "&&", 
           RowBox[{"y", "<=", "x"}]}]}], "}"}], ",", 
        RowBox[{"(*", "Value_Wins", "*)"}], 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"x", ">", "y"}]}], "}"}], ",", 
        RowBox[{"(*", "Check_Wins", "*)"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", 
          RowBox[{"x", "<=", "y"}]}], "}"}]}], 
       "                                                                      \
              ", 
       RowBox[{"(*", "Check_Loses", "*)"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "Expected"}]}], " ", 
      RowBox[{"Payoff", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expectedPayoffCP", "[", "B_", "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"payoffCP", "[", 
        RowBox[{"B", ",", "x", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"B", ">", "0"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Example", ":", 
     RowBox[{
     "evaluate", " ", "symbolically", " ", "or", " ", "numerically"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"expectedPayoffCP", "[", "B", "]"}], "\n", 
   RowBox[{
    RowBox[{"expectedPayoffCP", "[", "1", "]"}], "//", "N"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.955201173571457*^9, 3.955201197742803*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"bce81c24-a67a-4bf0-b70e-6d97aeead8d4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"0.5`", " ", "B"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.`", "\[VeryThinSpace]", "+", "B"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1.`", "\[VeryThinSpace]", "+", 
     RowBox[{"2.`", " ", "B"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.9552011892457867`*^9, 3.955201199869491*^9}},
 CellLabel->"Out[73]=",ExpressionUUID->"16493622-422e-4368-a9a2-e40a6dbd41e5"],

Cell[BoxData["0.05555555555555555`"], "Output",
 CellChangeTimes->{{3.9552011892457867`*^9, 3.955201199895548*^9}},
 CellLabel->"Out[74]=",ExpressionUUID->"c8a45e17-3812-4316-a445-81c1140caf60"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"-", 
      RowBox[{"Setup", "--"}]}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "LCPb", ",", "LCPv", ",", "x0", ",", "x1", ",", "x2", ",", "x3", ",", 
     "x4", ",", "x5", ",", "b0", ",", "A0", ",", "A1", ",", "A2", ",", "A3", 
     ",", "A4", ",", "A5"}], "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LCPb", "[", 
      RowBox[{"s_", ",", "b0_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"b0", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "s"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"x2", "-", "1"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"6", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "s"}], ")"}], "^", "3"}]}], ")"}]}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LCPv", "[", 
      RowBox[{"s_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x2", "+", 
        RowBox[{"2", " ", 
         RowBox[{"s", "^", "2"}]}], "+", 
        RowBox[{"4", " ", "s"}], "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "s"}], ")"}], "^", "2"}]}], ")"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"callThreshold", "[", 
      RowBox[{"s_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x2", "+", "s"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "s"}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"callThresholdInv", "[", 
      RowBox[{"y_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x2", "-", "y"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "y"}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"vOfS", "[", 
      RowBox[{"s_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"LCPv", "[", 
      RowBox[{"s", ",", "x2"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Inverses", " ", "of", " ", "b", 
     RowBox[{"(", "s", ")"}], " ", "and", " ", "v", 
     RowBox[{"(", "s", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sBluff", "[", 
      RowBox[{"x_", ",", "b0_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"s", "/.", " ", 
      RowBox[{"First", "@", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"LCPb", "[", 
            RowBox[{"s", ",", "b0", ",", "x2"}], "]"}], "==", "x"}], "&&", 
          RowBox[{"s", ">", "0"}]}], ",", "s", ",", "Reals"}], "]"}]}]}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"sValue", "[", 
      RowBox[{"x_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"s", "/.", " ", 
      RowBox[{"First", "@", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"LCPv", "[", 
            RowBox[{"s", ",", "x2"}], "]"}], "==", "x"}], "&&", 
          RowBox[{"s", ">", "0"}]}], ",", "s", ",", "Reals"}], "]"}]}]}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", "Thresholds", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A0", "[", "U_", "]"}], ":=", 
     RowBox[{
      RowBox[{"U", "^", "2"}], "+", 
      RowBox[{"3", " ", "U"}], "+", "3"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"A1", "[", "U_", "]"}], ":=", 
     RowBox[{
      RowBox[{"7", " ", 
       RowBox[{"U", "^", "3"}]}], "+", 
      RowBox[{"21", " ", 
       RowBox[{"U", "^", "2"}]}], "+", 
      RowBox[{"21", " ", "U"}], "+", "6"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"A2", "[", "U_", "]"}], ":=", 
     RowBox[{
      RowBox[{"6", " ", 
       RowBox[{"U", "^", "3"}]}], "+", 
      RowBox[{"18", " ", 
       RowBox[{"U", "^", "2"}]}], "+", 
      RowBox[{"18", " ", "U"}], "+", "5"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"A3", "[", "U_", "]"}], ":=", 
     RowBox[{
      RowBox[{"7", " ", 
       RowBox[{"U", "^", "3"}]}], "+", 
      RowBox[{"21", " ", 
       RowBox[{"U", "^", "2"}]}], "+", 
      RowBox[{"18", " ", "U"}], "+", "3"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"A4", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"A1", "[", "U", "]"}], " ", 
       RowBox[{"L", "^", "2"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"A1", "[", "U", "]"}], " ", "L"}], "+", 
      RowBox[{"A1", "[", "U", "]"}], "+", 
      RowBox[{
       RowBox[{"A2", "[", "U", "]"}], " ", 
       RowBox[{"L", "^", "3"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"A5", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"A0", "[", "U", "]"}], " ", 
       RowBox[{"L", "^", "2"}], " ", "U"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"A0", "[", "U", "]"}], " ", "L", " ", "U"}], "+", 
      RowBox[{
       RowBox[{"A0", "[", "U", "]"}], " ", "U"}], "-", 
      RowBox[{"L", "^", "3"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"x0", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "+", "1"}], ")"}], "^", "3"}], " ", "U"}], ")"}], "/", 
      
      RowBox[{"A4", "[", 
       RowBox[{"L", ",", "U"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"A0", "[", "U", "]"}], " ", "L", " ", "U"}], "+", 
        RowBox[{
         RowBox[{"A0", "[", "U", "]"}], " ", "U"}], "-", 
        RowBox[{"L", "^", "3"}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"L", "^", "2"}]}]}], ")"}], "/", 
      RowBox[{"A4", "[", 
       RowBox[{"L", ",", "U"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"x2", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A5", "[", 
       RowBox[{"L", ",", "U"}], "]"}], "/", 
      RowBox[{"A4", "[", 
       RowBox[{"L", ",", "U"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"x3", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"A2", "[", "U", "]"}], " ", 
         RowBox[{"L", "^", "3"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"A2", "[", "U", "]"}], " ", 
         RowBox[{"L", "^", "2"}]}], "+", 
        RowBox[{"3", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", 
            RowBox[{"U", "^", "3"}]}], "+", 
           RowBox[{"15", " ", 
            RowBox[{"U", "^", "2"}]}], "+", 
           RowBox[{"15", " ", "U"}], "+", "4"}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"U", "^", "3"}]}], "+", 
        RowBox[{"12", " ", 
         RowBox[{"U", "^", "2"}]}], "+", 
        RowBox[{"12", " ", "U"}], "+", "3"}], ")"}], "/", 
      RowBox[{"A4", "[", 
       RowBox[{"L", ",", "U"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"x4", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"A1", "[", "U", "]"}], " ", 
         RowBox[{"L", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"A2", "[", "U", "]"}], " ", 
         RowBox[{"L", "^", "3"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"A2", "[", "U", "]"}], " ", "L"}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"U", "^", "3"}]}], "+", 
        RowBox[{"12", " ", 
         RowBox[{"U", "^", "2"}]}], "+", 
        RowBox[{"12", " ", "U"}], "+", "3"}], ")"}], "/", 
      RowBox[{"A4", "[", 
       RowBox[{"L", ",", "U"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"x5", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"A3", "[", "U", "]"}], " ", 
         RowBox[{"L", "^", "2"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"A3", "[", "U", "]"}], " ", "L"}], "+", 
        RowBox[{"A3", "[", "U", "]"}], "+", 
        RowBox[{
         RowBox[{"L", "^", "3"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", 
            RowBox[{"U", "^", "3"}]}], "+", 
           RowBox[{"18", " ", 
            RowBox[{"U", "^", "2"}]}], "+", 
           RowBox[{"15", " ", "U"}], "+", "2"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"A4", "[", 
       RowBox[{"L", ",", "U"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"b0", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "+", "1"}], ")"}], "^", "3"}], ")"}]}], "/", 
      RowBox[{"A4", "[", 
       RowBox[{"L", ",", "U"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", 
       RowBox[{"Regions", "--"}]}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionBluff1", "[", 
      RowBox[{"L_", ",", "U_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{"0.5", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"x0", "[", 
          RowBox[{"L", ",", "U"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", 
         RowBox[{"callThreshold", "[", 
          RowBox[{"U", ",", "x2"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionBluff2", "[", 
      RowBox[{"L_", ",", "U_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "U"}], "-", "0.5"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"x0", "[", 
          RowBox[{"L", ",", "U"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"callThreshold", "[", 
          RowBox[{"U", ",", "x2"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionBluff3", "[", 
      RowBox[{"L_", ",", "U_", ",", "x2_", ",", "b0_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", 
            RowBox[{
             RowBox[{"vOfS", "[", 
              RowBox[{
               RowBox[{"callThresholdInv", "[", 
                RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], "<", 
             "x"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sBluff", "[", 
               RowBox[{"x", ",", "b0", ",", "x2"}], "]"}]}], "-", "0.5"}], 
            ",", 
            RowBox[{
             RowBox[{"vOfS", "[", 
              RowBox[{
               RowBox[{"callThresholdInv", "[", 
                RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
             "x"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"x0", "[", 
          RowBox[{"L", ",", "U"}], "]"}], ",", 
         RowBox[{"x1", "[", 
          RowBox[{"L", ",", "U"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionBluff4", "[", 
      RowBox[{"L_", ",", "U_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", 
            RowBox[{
             RowBox[{"vOfS", "[", 
              RowBox[{
               RowBox[{"callThresholdInv", "[", 
                RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], "<", 
             "x"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "L"}], "-", "0.5"}], ",", 
            RowBox[{
             RowBox[{"vOfS", "[", 
              RowBox[{
               RowBox[{"callThresholdInv", "[", 
                RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
             "x"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"x1", "[", 
          RowBox[{"L", ",", "U"}], "]"}], ",", 
         RowBox[{"x2", "[", 
          RowBox[{"L", ",", "U"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionCheck", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", 
            RowBox[{"x", ">", "y"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"x", "<=", "y"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"x2", "[", 
          RowBox[{"L", ",", "U"}], "]"}], ",", 
         RowBox[{"x3", "[", 
          RowBox[{"L", ",", "U"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionValue1", "[", 
      RowBox[{"L_", ",", "U_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", 
            RowBox[{
             RowBox[{"vOfS", "[", 
              RowBox[{
               RowBox[{"callThresholdInv", "[", 
                RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], "<", 
             "x"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "L"}], "-", "0.5"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vOfS", "[", 
               RowBox[{
                RowBox[{"callThresholdInv", "[", 
                 RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
              "x"}], "&&", 
             RowBox[{"y", ">", "x"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"L", "+", "0.5"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vOfS", "[", 
               RowBox[{
                RowBox[{"callThresholdInv", "[", 
                 RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
              "x"}], "&&", 
             RowBox[{"y", "<=", "x"}]}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"x3", "[", 
          RowBox[{"L", ",", "U"}], "]"}], ",", 
         RowBox[{"x4", "[", 
          RowBox[{"L", ",", "U"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionValue2", "[", 
      RowBox[{"L_", ",", "U_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", 
            RowBox[{
             RowBox[{"vOfS", "[", 
              RowBox[{
               RowBox[{"callThresholdInv", "[", 
                RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], "<", 
             "x"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sValue", "[", 
               RowBox[{"x", ",", "x2"}], "]"}]}], "-", "0.5"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vOfS", "[", 
               RowBox[{
                RowBox[{"callThresholdInv", "[", 
                 RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
              "x"}], "&&", 
             RowBox[{"y", ">", "x"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sValue", "[", 
              RowBox[{"x", ",", "x2"}], "]"}], "+", "0.5"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vOfS", "[", 
               RowBox[{
                RowBox[{"callThresholdInv", "[", 
                 RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
              "x"}], "&&", 
             RowBox[{"y", "<=", "x"}]}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"x4", "[", 
          RowBox[{"L", ",", "U"}], "]"}], ",", 
         RowBox[{"x5", "[", 
          RowBox[{"L", ",", "U"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffRegionValue3", "[", 
      RowBox[{"L_", ",", "U_", ",", "x2_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", 
            RowBox[{
             RowBox[{"vOfS", "[", 
              RowBox[{
               RowBox[{"callThresholdInv", "[", 
                RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], "<", 
             "x"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "U"}], "-", "0.5"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vOfS", "[", 
               RowBox[{
                RowBox[{"callThresholdInv", "[", 
                 RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
              "x"}], "&&", 
             RowBox[{"y", ">", "x"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"U", "+", "0.5"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vOfS", "[", 
               RowBox[{
                RowBox[{"callThresholdInv", "[", 
                 RowBox[{"y", ",", "x2"}], "]"}], ",", "x2"}], "]"}], ">=", 
              "x"}], "&&", 
             RowBox[{"y", "<=", "x"}]}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"x5", "[", 
          RowBox[{"L", ",", "U"}], "]"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "Total"}]}], " ", "Expected", " ", 
      RowBox[{"Value", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expectedPayoffLCP", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2val", "=", 
          RowBox[{"x2", "[", 
           RowBox[{"L", ",", "U"}], "]"}]}], ",", 
         RowBox[{"b0val", "=", 
          RowBox[{"b0", "[", 
           RowBox[{"L", ",", "U"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Total", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"payoffRegionBluff1", "[", 
           RowBox[{"L", ",", "U", ",", "x2val"}], "]"}], ",", 
          RowBox[{"payoffRegionBluff2", "[", 
           RowBox[{"L", ",", "U", ",", "x2val"}], "]"}], ",", 
          RowBox[{"payoffRegionBluff3", "[", 
           RowBox[{"L", ",", "U", ",", "x2val", ",", "b0val"}], "]"}], ",", 
          RowBox[{"payoffRegionBluff4", "[", 
           RowBox[{"L", ",", "U", ",", "x2val"}], "]"}], ",", 
          RowBox[{"payoffRegionCheck", "[", 
           RowBox[{"L", ",", "U"}], "]"}], ",", 
          RowBox[{"payoffRegionValue1", "[", 
           RowBox[{"L", ",", "U", ",", "x2val"}], "]"}], ",", 
          RowBox[{"payoffRegionValue2", "[", 
           RowBox[{"L", ",", "U", ",", "x2val"}], "]"}], ",", 
          RowBox[{"payoffRegionValue3", "[", 
           RowBox[{"L", ",", "U", ",", "x2val"}], "]"}]}], "}"}]}]}], "]"}]}],
     ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", "Evaluate", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expectedPayoffLCP", "[", 
     RowBox[{"0.3", ",", "2"}], "]"}], "//", "N"}], "\n", "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.9552012979599857`*^9, 3.955201297979392*^9}, {
  3.955202748434986*^9, 3.955202770153709*^9}, {3.955203283977597*^9, 
  3.955203286641387*^9}, {3.955205289526495*^9, 
  3.955205294621316*^9}},ExpressionUUID->"80c45929-b57e-4c60-ba41-\
c876e993c6e6"]
},
WindowSize->{Full, Full},
WindowMargins->{{352, Automatic}, {Automatic, 50}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c3df3460-b2b7-4a48-882d-5cc9bb71ac3b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6792, 193, 514, "Input",ExpressionUUID->"bce81c24-a67a-4bf0-b70e-6d97aeead8d4"],
Cell[7375, 217, 414, 10, 52, "Output",ExpressionUUID->"16493622-422e-4368-a9a2-e40a6dbd41e5"],
Cell[7792, 229, 194, 2, 34, "Output",ExpressionUUID->"c8a45e17-3812-4316-a445-81c1140caf60"]
}, Open  ]],
Cell[8001, 234, 21297, 624, 1333, "Input",ExpressionUUID->"80c45929-b57e-4c60-ba41-c876e993c6e6"]
}
]
*)

(* End of internal cache information *)

