(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59401,       1688]
NotebookOptionsPosition[     57024,       1648]
NotebookOutlinePosition[     57416,       1664]
CellTagsIndexPosition[     57373,       1661]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "for"}]}]}]}]}]}]}]}]}]}], " ", "fixed", " ", 
    "bet", " ", "size", " ", "continuous", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"poker", "--"}], "--"}], "--"}], "--"}], "--"}], 
              "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
      "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bluffThreshold", "[", "s_", "]"}], ":=", 
    RowBox[{"2", " ", 
     RowBox[{"s", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "s"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"2", " ", "s"}]}], ")"}]}], ")"}]}]}]}], "\n", 
   RowBox[{
    RowBox[{"valueThreshold", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"8", " ", "s"}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"s", "^", "2"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "s"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"2", " ", "s"}]}], ")"}]}], ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{"callThreshold", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", " ", "s", " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", "s"}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "s"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"2", " ", "s"}]}], ")"}]}], ")"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"payoff", " ", "to", " ", "the", " ", "bettor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"payoffFixed", "[", 
     RowBox[{"s_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bth", ",", "vth", ",", "cth"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bth", ",", "vth", ",", "cth"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"bluffThreshold", "[", "s", "]"}], ",", 
          RowBox[{"valueThreshold", "[", "s", "]"}], ",", 
          RowBox[{"callThreshold", "[", "s", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"x", "<", "bth"}], ",", 
         RowBox[{"(*", 
          RowBox[{"x", " ", "bluffs"}], "*)"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", ">", "cth"}], ",", 
           RowBox[{
            RowBox[{"-", "s"}], "-", "0.5"}], ",", "0.5"}], "]"}], ",", 
         RowBox[{"x", ">", "vth"}], ",", 
         RowBox[{"(*", 
          RowBox[{"x", " ", "value", " ", "bets"}], "*)"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", ">", "cth"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"y", "<", "x"}], ",", 
             RowBox[{"s", "+", "0.5"}], ",", 
             RowBox[{
              RowBox[{"-", "s"}], "-", "0.5"}]}], "]"}], ",", "0.5"}], "]"}], 
         ",", "True", ",", 
         RowBox[{"(*", 
          RowBox[{"x", " ", "checks"}], "*)"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"x", ">", "y"}], ",", "0.5", ",", 
           RowBox[{"-", "0.5"}]}], "]"}]}], "]"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.954939688365219*^9, 3.954939783115768*^9}, {
   3.954939816294314*^9, 3.954939870000237*^9}, {3.954940015398882*^9, 
   3.954940044471393*^9}, {3.9549401912510757`*^9, 3.954940208981221*^9}, {
   3.954940273389263*^9, 3.954940394659995*^9}, {3.954940913359351*^9, 
   3.954940962558745*^9}, {3.954941090455195*^9, 3.9549411311015167`*^9}, {
   3.954941172278051*^9, 3.954941203552361*^9}, {3.954941237730475*^9, 
   3.9549412379641447`*^9}, {3.954942177833665*^9, 3.9549421814833193`*^9}, 
   3.954971775974504*^9, {3.954971807793304*^9, 3.954971891024619*^9}, 
   3.954971941221443*^9, {3.955098971511957*^9, 3.955098986391809*^9}, {
   3.9550990331226*^9, 3.95509903435089*^9}, {3.9550991234959908`*^9, 
   3.955099128630891*^9}},ExpressionUUID->"b96d007d-ca3e-4d4f-8d4c-\
fcc6d655c3ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", "for"}]}]}]}]}]}]}]}]}]}], " ", "no", " ", "limit", 
    " ", "continuous", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"poker", "--"}], "--"}], "--"}], "--"}], "--"}], 
                  "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
           "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bluffThresholdNoLimit", " ", "=", " ", 
     RowBox[{"1", "/", "7"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"valueThresholdNoLimit", " ", "=", " ", 
     RowBox[{"4", "/", "7"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "Inverse"}]}], " ", 
      RowBox[{"formulas", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bluffS", "[", "x_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "<=", "0"}], "||", 
       RowBox[{"x", ">=", 
        RowBox[{"1", "/", "7"}]}]}], ",", "Indeterminate", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"7", " ", "x"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "3"}], ")"}]}]}], ")"}], "-", "1"}]}], "]"}]}], 
   "\n", 
   RowBox[{
    RowBox[{"valueS", "[", "x_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "<=", 
        RowBox[{"4", "/", "7"}]}], "||", 
       RowBox[{"x", ">=", "1"}]}], ",", "Indeterminate", ",", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"3", "/", 
         RowBox[{"(", 
          RowBox[{"7", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}]}], ")"}]}], "]"}], "-", "1"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "Caller"}]}], " ", 
      RowBox[{"threshold", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"callThresholdNoLimit", "[", "s_", "]"}], " ", ":=", " ", 
    RowBox[{"1", " ", "-", " ", 
     RowBox[{"6", "/", 
      RowBox[{"(", 
       RowBox[{"7", " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", "s"}], ")"}]}], ")"}]}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"payoffNoLimit", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "s", "}"}], ",", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"x", "<", "bluffThresholdNoLimit"}], ",", 
         RowBox[{
          RowBox[{"s", "=", 
           RowBox[{"bluffS", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericQ", "[", "s", "]"}], "&&", 
             RowBox[{"s", ">", "0"}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"y", ">", 
               RowBox[{"callThresholdNoLimit", "[", "s", "]"}]}], ",", 
              RowBox[{
               RowBox[{"-", "s"}], "-", "0.5"}], ",", "0.5"}], "]"}], ",", 
            "Indeterminate"}], "]"}]}], ",", 
         RowBox[{"x", ">", "valueThresholdNoLimit"}], ",", 
         RowBox[{
          RowBox[{"s", "=", 
           RowBox[{"valueS", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericQ", "[", "s", "]"}], "&&", 
             RowBox[{"s", ">", "0"}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"y", ">", 
               RowBox[{"callThresholdNoLimit", "[", "s", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"y", "<", "x"}], ",", 
                RowBox[{"s", "+", "0.5"}], ",", 
                RowBox[{
                 RowBox[{"-", "s"}], "-", "0.5"}]}], "]"}], ",", "0.5"}], 
             "]"}], ",", "Indeterminate"}], "]"}]}], ",", "True", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"x", ">", "y"}], ",", "0.5", ",", 
           RowBox[{"-", "0.5"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0FsogwEABeC5NHkx15kRW4pRs0RoUUxbqU2xNddYai8o0rLmgW2ZhFiZ
KWSrUchlyAOFJcIU0XhxW420XKJcF392/ofT93LOy2E3tJQrAykUCtsfKG3c
KlSpn4s6d3xCeEXViKHTyyiFlnyNDNq/euVwm6AqYHSHVQnvhsxtsGGf0w3N
vI9LrV+NRH0NXVlNj5A+s/sM265Mb3BFKfuEBRS2j+zVzxJwNL6AqvObHm4j
/Z2uDYPWmlwanCCC40hHnpjwIS4zFYq6PWmQaXjgwkr+dyZ87fsthnPjFSIo
rmXVwawbN+ny6HAjTOBEtsKDAYkK5k23tsP345cuKMsRaGGK+8QAJz1eUpOm
zAgXQt5sMNvAmIE/UUdL0Nnzfg5LVAEXsFCRfAsPjRY3uV/L+YODnlgCOlLO
AvV+p1rugyB/IzEGiuihSdA+7+LA3vhIHjzTdlbBvQNWDbyJ8OmgYK9aD809
xBhpc8Y4uZP3Lzrwp1C6DldPuZtQxqVtwX+wtxNW
  
  "],ExpressionUUID->"0c0bc020-0b4e-42e9-a75e-6141ae42bf3c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", "LU"}]}]}]}]}]}]}]}], " ", "Limit", " ", "Continuous",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Poker", "--"}], "--"}], "--"}], "--"}], "--"}], 
                   "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
            "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Keep", " ", "the", " ", "bettor", " ", "indifferent", " ", "between", " ",
     "bluffing", " ", "any", " ", "amount", " ", "and", " ", "checking", " ", 
    "at", " ", "the", " ", "max", " ", "bluffing", " ", "hand", " ", 
    "strength"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"bluffIndiff", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "s", "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"c", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"-", "s"}], ")"}]}]}], "==", "x2"}]}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Keep", " ", "the", " ", "caller", " ", "indifferent", " ", "between", 
     " ", "calling", " ", "and", " ", "folding", " ", "to", " ", "a", " ", 
     "bet", " ", 
     RowBox[{"(", 
      RowBox[{"between", " ", "min", " ", "and", " ", "max"}], ")"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"callIndiff", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"b", "'"}], "[", "s", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "s"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "'"}], "[", "s", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"-", "s"}], ")"}]}]}], "==", "0"}]}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Keep", " ", "the", " ", "caller", " ", "indifferent", " ", "between", 
      " ", "calling", " ", "and", " ", "folding", " ", "to", " ", "an", " ", 
      "All"}], "-", "in"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"callIndiffMax", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"x0", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "U"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "x5"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"-", "U"}], ")"}]}]}], "==", "0"}]}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Keep", " ", "the", " ", "caller", " ", "indifferent", " ", "between", 
     " ", "calling", " ", "and", " ", "folding", " ", "to", " ", "a", " ", 
     "min", " ", "bet"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"callIndiffMin", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x2", "-", "x1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "L"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x4", "-", "x3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"-", "L"}], ")"}]}]}], "==", "0"}]}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "size", " ", "that", " ", "the", " ", "bettor", " ", "uses", 
     " ", "for", " ", "a", " ", "value", " ", "bet", " ", "must", " ", 
     "maximize", " ", "EV"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "comes", " ", "from", " ", "differentiating", " ", "the", 
     " ", "EV", " ", "of", " ", "bet", " ", "return", " ", "WRT", " ", "s", 
     " ", "and", " ", "setting", " ", "to", " ", "0"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"valueOptimality", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "s"}], "*", 
       RowBox[{
        RowBox[{"c", "'"}], "[", "s", "]"}]}], "-", 
      RowBox[{"c", "[", "s", "]"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"v", "[", "s", "]"}]}], "-", "1"}], "==", "0"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "boundary", " ", "points", " ", "of", " ", "the", " ", 
     "bluffing", " ", "function", " ", "and", " ", "value", " ", "function"}],
     "*)"}], "\n", 
   RowBox[{"boundaryConditions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"b", "[", "U", "]"}], "==", "x0"}], ",", 
      RowBox[{
       RowBox[{"b", "[", "L", "]"}], "==", "x1"}], ",", 
      RowBox[{
       RowBox[{"v", "[", "U", "]"}], "==", "x5"}], ",", 
      RowBox[{
       RowBox[{"v", "[", "L", "]"}], "==", "x4"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Keep", " ", "the", " ", "bettor", " ", "indifferent", " ", "between", 
     " ", "checking", " ", "and", " ", "making", " ", "a", " ", "min", " ", 
     "value", " ", "bet", " ", "with", " ", "the", " ", "most", " ", 
     "marginal", " ", "value", " ", "betting", " ", "hand"}], "*)"}], "\n", 
   RowBox[{"valueIndiff", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "L", "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "L"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"x3", "-", 
         RowBox[{"c", "[", "L", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "x3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"-", "L"}], ")"}]}]}], "==", "x3"}]}]}]}]], "Input",
 CellChangeTimes->{{3.954515907690877*^9, 3.954515907708831*^9}, 
   3.954594147933509*^9, 3.954942167518333*^9, {3.955099089293038*^9, 
   3.955099137100543*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"c54378ae-061f-4309-9316-8708aa0e0429"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "s"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"c", "[", "s", "]"}]}], ")"}]}], "+", 
   RowBox[{"c", "[", "s", "]"}]}], "\[Equal]", "x2"}]], "Output",
 CellChangeTimes->{{3.9545159169392242`*^9, 3.954515935708808*^9}, 
   3.954593634036127*^9, 3.954594149404305*^9, 3.9547561646048927`*^9, 
   3.955099233983252*^9, 3.955481596162548*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"7c5ab5b5-b399-4256-b504-fd913699efc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "s"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["b", "\[Prime]",
      MultilineFunction->None], "[", "s", "]"}]}], "+", 
   RowBox[{"s", " ", 
    RowBox[{
     SuperscriptBox["v", "\[Prime]",
      MultilineFunction->None], "[", "s", "]"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.9545159169392242`*^9, 3.954515935708808*^9}, 
   3.954593634036127*^9, 3.954594149404305*^9, 3.9547561646048927`*^9, 
   3.955099233983252*^9, 3.955481596183899*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"afb51589-fc0c-4f3f-b253-d8738be744b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "U"}], ")"}], " ", "x0"}], "-", 
   RowBox[{"U", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x5"}], ")"}]}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.9545159169392242`*^9, 3.954515935708808*^9}, 
   3.954593634036127*^9, 3.954594149404305*^9, 3.9547561646048927`*^9, 
   3.955099233983252*^9, 3.95548159618548*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"40b26a9a-3611-47d2-ae44-f2ae4df091c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "L"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], ")"}]}], "-", 
   RowBox[{"L", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "x3"}], "+", "x4"}], ")"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.9545159169392242`*^9, 3.954515935708808*^9}, 
   3.954593634036127*^9, 3.954594149404305*^9, 3.9547561646048927`*^9, 
   3.955099233983252*^9, 3.955481596186964*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"8310c6c4-6fd1-49aa-a4bc-6e8d75a30556"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "1"}], "-", 
   RowBox[{"c", "[", "s", "]"}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"v", "[", "s", "]"}]}], "-", 
   RowBox[{"s", " ", 
    RowBox[{
     SuperscriptBox["c", "\[Prime]",
      MultilineFunction->None], "[", "s", "]"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.9545159169392242`*^9, 3.954515935708808*^9}, 
   3.954593634036127*^9, 3.954594149404305*^9, 3.9547561646048927`*^9, 
   3.955099233983252*^9, 3.955481596191251*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"73f528ec-64b6-4d30-aa6d-9238501901e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", "U", "]"}], "\[Equal]", "x0"}], ",", 
   RowBox[{
    RowBox[{"b", "[", "L", "]"}], "\[Equal]", "x1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", "U", "]"}], "\[Equal]", "x5"}], ",", 
   RowBox[{
    RowBox[{"v", "[", "L", "]"}], "\[Equal]", "x4"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9545159169392242`*^9, 3.954515935708808*^9}, 
   3.954593634036127*^9, 3.954594149404305*^9, 3.9547561646048927`*^9, 
   3.955099233983252*^9, 3.955481596207559*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"6a147ae4-a92d-4a16-970d-2e0e534fd295"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "L"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x3"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "L"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"x3", "-", 
      RowBox[{"c", "[", "L", "]"}]}], ")"}]}], "+", 
   RowBox[{"c", "[", "L", "]"}]}], "\[Equal]", "x3"}]], "Output",
 CellChangeTimes->{{3.9545159169392242`*^9, 3.954515935708808*^9}, 
   3.954593634036127*^9, 3.954594149404305*^9, 3.9547561646048927`*^9, 
   3.955099233983252*^9, 3.9554815962096252`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"523b16a3-9416-486f-b5ad-d06bf7a3fa37"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Solve", " ", "for", " ", "c", 
    RowBox[{"(", "s", ")"}], " ", "first"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Csol", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", "bluffIndiff", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", "[", "s", "]"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Use", " ", "c", 
     RowBox[{"(", "s", ")"}], " ", "to", " ", "solve", " ", "for", " ", "v", 
     RowBox[{"(", "s", ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Vsol", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"valueOptimality", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"c", "'"}], "[", "s", "]"}], "->", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"c", "[", "s", "]"}], "/.", " ", "Csol"}], ",", "s"}],
               "]"}]}], "}"}]}], "/.", " ", "Csol"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", "[", "s", "]"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Use", " ", "v", 
      RowBox[{"(", "s", ")"}], " ", "to", " ", "solve", " ", "for", " ", "b", 
      
      RowBox[{"(", "s", ")"}]}], ",", 
     RowBox[{
     "getting", " ", "an", " ", "extra", " ", "constant", " ", "of", " ", 
      "integration", " ", "C1"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Bsol", "=", 
     RowBox[{
      RowBox[{"DSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"callIndiff", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "'"}], "[", "s", "]"}], "->", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "s", "]"}], "/.", " ", "Vsol"}], "/.", " ", 
               "Csol"}], ",", "s"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"b", "[", "s", "]"}], ",", "s", ",", 
        RowBox[{"GeneratedParameters", "->", 
         RowBox[{"(", 
          RowBox[{"C1", "&"}], ")"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"callIndiffMax", ",", "callIndiffMin", ",", "valueIndiff"}],
           "}"}], ",", "boundaryConditions"}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "[", "s_", "]"}], "->", 
          RowBox[{"b", "[", "s", "]"}]}], "/.", " ", "Bsol"}], "}"}]}], "/.", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "s_", "]"}], "->", 
         RowBox[{"v", "[", "s", "]"}]}], "/.", " ", "Vsol"}], "}"}]}], "/.", 
     " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "s_", "]"}], "->", 
        RowBox[{"c", "[", "s", "]"}]}], "/.", " ", "Csol"}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Use", " ", "v", 
      RowBox[{"(", "s", ")"}]}], ",", 
     RowBox[{"c", 
      RowBox[{"(", "s", ")"}]}], ",", 
     RowBox[{"and", " ", "b", 
      RowBox[{"(", "s", ")"}], " ", "with", " ", "all", " ", "our", " ", 
      "equations", " ", "to", " ", "solve", " ", "for", " ", "all", " ", 
      "the", " ", "scalars"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xsol", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "callIndiffMax", ",", "callIndiffMin", ",", "valueIndiff"}], 
               "}"}], ",", "boundaryConditions"}], "]"}], "/.", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"b", "[", "s_", "]"}], "->", 
               RowBox[{"b", "[", "s", "]"}]}], "/.", " ", "Bsol"}], "}"}]}], "/.",
            " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "s_", "]"}], "->", 
              RowBox[{"v", "[", "s", "]"}]}], "/.", " ", "Vsol"}], "}"}]}], "/.",
           " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", "s_", "]"}], "->", 
             RowBox[{"c", "[", "s", "]"}]}], "/.", " ", "Csol"}], "}"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
           "C1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Plug", " ", "the", " ", "scalars", " ", "back", " ", "into", " ", "the", 
     " ", "function", " ", "solutions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LimitSol", "=", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"Vsol", "/.", " ", "Xsol"}], ",", 
        RowBox[{"Csol", "/.", " ", "Xsol"}], ",", 
        RowBox[{"Bsol", "/.", " ", "Xsol"}], ",", "Xsol"}], "]"}], "//", 
      "Simplify"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.954515914884069*^9, 3.954515933173283*^9}, {
  3.954515979669629*^9, 3.95451599966115*^9}, {3.954591604991323*^9, 
  3.9545916695071907`*^9}, {3.954591772099989*^9, 3.9545917795700502`*^9}, {
  3.954593442726386*^9, 3.9545934845270233`*^9}, {3.9545935213780403`*^9, 
  3.954593572688067*^9}, {3.954593638805785*^9, 3.954593652298394*^9}, {
  3.955486042853814*^9, 3.955486050450592*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"084393d7-ca42-4a4e-a6df-8e5e8d432fa4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"define", " ", "the", " ", "final", " ", "functions", " ", "b"}], 
    ",", "c", ",", 
    RowBox[{"and", " ", "v"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"s_", ",", "L_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", "[", "s", "]"}], "/.", " ", "LimitSol"}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"s_", ",", "L_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", "[", "s", "]"}], "/.", " ", "LimitSol"}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"s_", ",", "L_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", "s", "]"}], "/.", " ", "LimitSol"}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x0", "[", 
     RowBox[{"L_", ",", "U_"}], "]"}], " ", ":=", " ", 
    RowBox[{"x0", " ", "/.", "LimitSol"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1", "[", 
     RowBox[{"L_", ",", "U_"}], "]"}], " ", ":=", " ", 
    RowBox[{"x1", " ", "/.", "LimitSol"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", "[", 
     RowBox[{"L_", ",", "U_"}], "]"}], " ", ":=", " ", 
    RowBox[{"x2", " ", "/.", "LimitSol"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x3", "[", 
     RowBox[{"L_", ",", "U_"}], "]"}], " ", ":=", " ", 
    RowBox[{"x3", " ", "/.", "LimitSol"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x4", "[", 
     RowBox[{"L_", ",", "U_"}], "]"}], " ", ":=", " ", 
    RowBox[{"x4", " ", "/.", "LimitSol"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x5", "[", 
     RowBox[{"L_", ",", "U_"}], "]"}], " ", ":=", " ", 
    RowBox[{"x5", " ", "/.", "LimitSol"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", "analysis"}]}]}]}]}]}]}], " ", "of", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"payoff", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
      "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cInv", "[", 
      RowBox[{"y_", ",", "L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x2", "[", 
         RowBox[{"L", ",", "U"}], "]"}], "-", "y"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"y", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loseShowdownPayoff", "[", 
      RowBox[{"sIntegral_", ",", "area_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "sIntegral"}], "-", 
      RowBox[{"0.5", "*", "area"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"winShowdownPayoff", "[", 
      RowBox[{"sIntegral_", ",", "area_"}], "]"}], ":=", 
     RowBox[{"sIntegral", "+", 
      RowBox[{"0.5", "*", "area"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"loseAntePayoff", "[", "area_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "0.5"}], "*", "area"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"winAntePayoff", "[", "area_", "]"}], ":=", 
     RowBox[{"0.5", "*", "area"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InverseIntegrate", "[", 
     RowBox[{"f_", ",", "s_", ",", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Integrate", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "a", ",", "b"}], "}"}]}], "]"}]}], "+", 
       RowBox[{"b", "*", "f"}]}], "/.", " ", 
      RowBox[{"s", "->", 
       RowBox[{"b", "-", 
        RowBox[{"a", "*", "f"}]}]}]}], "/.", " ", 
     RowBox[{"s", "->", "a"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ConstantRegion", "[", 
      RowBox[{
      "sval_", ",", "xMin_", ",", "xMax_", ",", "yMin_", ",", "yMax_", ",", 
       "payoffFunc_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "area", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"area", "=", 
         RowBox[{"Integrate", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "yMin", ",", "yMax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xMin", ",", "xMax"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"payoffFunc", "[", 
         RowBox[{
          RowBox[{"sval", "*", "area"}], ",", "area"}], "]"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"VariableRegion", "[", 
      RowBox[{
      "s0_", ",", "s1_", ",", "yMin_", ",", "yMax_", ",", "xFunc_", ",", 
       "payoffFunc_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"area", ",", "sInt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"area", "=", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xFunc", "[", 
             RowBox[{"s1", "[", "y", "]"}], "]"}], "-", 
            RowBox[{"xFunc", "[", 
             RowBox[{"s0", "[", "y", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "yMin", ",", "yMax"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sInt", "=", 
         RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"InverseIntegrate", "[", 
            RowBox[{"xFunc", ",", "s", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s0", "[", "y", "]"}], ",", 
               RowBox[{"s1", "[", "y", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"y", ",", "yMin", ",", "yMax"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"payoffFunc", "[", 
         RowBox[{"sInt", ",", "area"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r0", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"U", ",", "0", ",", 
       RowBox[{"b", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r1", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"VariableRegion", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "U"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "L"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", 
         RowBox[{"b", "[", 
          RowBox[{"s", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r2", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"VariableRegion", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", 
         RowBox[{"cInv", "[", 
          RowBox[{"y", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "L"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", 
         RowBox[{"b", "[", 
          RowBox[{"s", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r3", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"L", ",", 
       RowBox[{"b", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"x2", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r4", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"b", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "winAntePayoff"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r5", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", 
       RowBox[{"b", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"b", "[", 
        RowBox[{
         RowBox[{"cInv", "[", 
          RowBox[{"y", ",", "L", ",", "U"}], "]"}], ",", "L", ",", "U"}], 
        "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "winAntePayoff"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r6", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"x2", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "0", ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", "winAntePayoff"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r7", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", 
       RowBox[{"x2", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "1", ",", "loseAntePayoff"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r8", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "y", ",", 
       RowBox[{"x2", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "loseAntePayoff"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r9", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", "y", ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"x2", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "winAntePayoff"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r10", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", 
       RowBox[{"x2", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "0", ",", 
       RowBox[{"x2", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "winAntePayoff"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r11", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"L", ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r12", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"L", ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "y", ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", "loseShowdownPayoff"}],
       "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r13", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"VariableRegion", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "L"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", 
         RowBox[{"v", "[", 
          RowBox[{"s", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r14", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"VariableRegion", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "L"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", 
         RowBox[{"v", "[", 
          RowBox[{"s", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r15", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"U", ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "y", ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       "loseShowdownPayoff"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r16", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"L", ",", "y", ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", "winShowdownPayoff"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r17", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"L", ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "winShowdownPayoff"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r18", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"VariableRegion", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "L"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", 
         RowBox[{"v", "[", 
          RowBox[{"s", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       "winShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r19", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"VariableRegion", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "L"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", 
         RowBox[{"v", "[", 
          RowBox[{"s", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       "winShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r20", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"VariableRegion", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", "L"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"y", ",", 
         RowBox[{"v", "[", 
          RowBox[{
           RowBox[{"cInv", "[", 
            RowBox[{"y", ",", "L", ",", "U"}], "]"}], ",", "L", ",", "U"}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", 
         RowBox[{"v", "[", 
          RowBox[{"s", ",", "L", ",", "U"}], "]"}]}], "]"}], ",", 
       "winShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r21", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"U", ",", "y", ",", "1", ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       "winShowdownPayoff"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r22", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"U", ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "1", ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "winShowdownPayoff"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r23", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", 
       RowBox[{"v", "[", 
        RowBox[{
         RowBox[{"cInv", "[", 
          RowBox[{"y", ",", "L", ",", "U"}], "]"}], ",", "L", ",", "U"}], 
        "]"}], ",", "1", ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", 
       RowBox[{"c", "[", 
        RowBox[{"U", ",", "L", ",", "U"}], "]"}], ",", "winAntePayoff"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"r24", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"ConstantRegion", "[", 
      RowBox[{"0", ",", 
       RowBox[{"x3", "[", 
        RowBox[{"L", ",", "U"}], "]"}], ",", "1", ",", "0", ",", 
       RowBox[{"c", "[", 
        RowBox[{"L", ",", "L", ",", "U"}], "]"}], ",", "winAntePayoff"}], 
      "]"}]}], ";"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.9545936735448503`*^9, 3.954593676272579*^9}, {
   3.95509922856487*^9, 3.955099230300845*^9}, {3.955485948054933*^9, 
   3.955486092338016*^9}, {3.9554861949976473`*^9, 3.955486222874175*^9}, {
   3.955486367727854*^9, 3.9554863936621513`*^9}, {3.955486655767674*^9, 
   3.955486730893318*^9}, {3.955486802726667*^9, 3.955486820389228*^9}, {
   3.955486864462521*^9, 3.955486924445716*^9}, 3.955487152293689*^9},
 CellLabel->
  "In[479]:=",ExpressionUUID->"a8ccc721-4392-4d91-9af2-c086aa5d3167"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"totalPayoff", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"Total", "[", 
      RowBox[{"Through", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "r0", ",", "r1", ",", "r2", ",", "r3", ",", "r4", ",", "r5", ",", 
          "r6", ",", "r7", ",", "r8", ",", "r9", ",", "r10", ",", "r11", ",", 
          "r12", ",", "r13", ",", "r14", ",", "r15", ",", "r16", ",", "r17", 
          ",", "r18", ",", "r19", ",", "r20", ",", "r21", ",", "r22", ",", 
          "r23", ",", "r24"}], "}"}], "[", 
        RowBox[{"L", ",", "U"}], "]"}], "]"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"totalPayoff", "[", 
      RowBox[{"L_", ",", "U_"}], "]"}], ":=", 
     RowBox[{"Total", "[", 
      RowBox[{"Through", "[", 
       RowBox[{
        RowBox[{"{", "r0", "}"}], "[", 
        RowBox[{"L", ",", "U"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.955200689300318*^9, 3.955200724855493*^9}, {
   3.955202902009757*^9, 3.9552029165802803`*^9}, {3.9552031840628147`*^9, 
   3.95520324025974*^9}, {3.955481636862741*^9, 3.95548163712162*^9}, {
   3.955486102691749*^9, 3.955486176709498*^9}, 3.955486221597678*^9, 
   3.9554863801109943`*^9, {3.955486831725534*^9, 3.955486832545932*^9}, {
   3.9554869340348597`*^9, 3.955486937476486*^9}, {3.9554873735427847`*^9, 
   3.9554874041971693`*^9}},
 CellLabel->
  "In[473]:=",ExpressionUUID->"022e959a-bcb4-4254-af00-15b9e252d901"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totalPayoff", "[", 
  RowBox[{"0.99", ",", " ", "1.01"}], "]"}]], "Input",
 CellChangeTimes->{{3.955486939666183*^9, 3.955486946865587*^9}},
 CellLabel->
  "In[474]:=",ExpressionUUID->"f2b00ea5-2f56-44ad-ac23-c58dade251a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1.51`"}], " ", 
  RowBox[{"b", "[", "1.01`", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"c", "[", "1.01`", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.955487046163715*^9, 3.955487255334236*^9, {3.9554873888264*^9, 
   3.955487406122747*^9}},
 CellLabel->
  "Out[474]=",ExpressionUUID->"e1ae2b95-82c9-4669-b2ba-65e6a9733251"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c", "[", 
  RowBox[{"L", ",", " ", "U", ",", " ", "L"}], "]"}]], "Input",
 CellChangeTimes->{{3.955487456293981*^9, 3.9554874611845427`*^9}, {
  3.955487503549776*^9, 3.955487559135734*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"154b0aec-2c71-4133-afe3-89f62933496a"],

Cell[BoxData[
 RowBox[{"c", "[", "L", "]"}]], "Output",
 CellChangeTimes->{
  3.9554874616500998`*^9, {3.955487508068157*^9, 3.955487559707028*^9}},
 CellLabel->
  "Out[524]=",ExpressionUUID->"6b086d7e-695a-4b56-be9d-6aa0aa9cbc60"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", "Substitution"}]}]}]}]}]}]}]}]}], " ", "and", " ", 
   "TEX", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"output", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
       "--"}], "--"}], "--"}], "--"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9552011092868357`*^9, 
  3.9552011359849*^9}},ExpressionUUID->"f270845f-93e1-4705-9428-990fa1a20382"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubstituteInRules", "[", 
    RowBox[{"rules_", ",", "replacements_"}], "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"updatedRules", ",", "rep"}], "}"}], ",", 
       RowBox[{"updatedRules", "/.", " ", "rep"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"updatedRules", "/.", " ", 
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"lhs_", ",", "rhs_"}], "]"}], ":>", 
         RowBox[{"Rule", "[", 
          RowBox[{"lhs", ",", 
           RowBox[{"rhs", "/.", " ", "rep"}]}], "]"}]}]}], "*)"}], "]"}], ",",
      "rules", ",", "replacements"}], "]"}]}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"replacements", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"U", "^", "2"}], "+", 
        RowBox[{"3", "U"}], "+", "3"}], "->", "A0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"7", 
         RowBox[{"U", "^", "3"}]}], "+", 
        RowBox[{"21", 
         RowBox[{"U", "^", "2"}]}], "+", 
        RowBox[{"21", "U"}], "+", "6"}], "->", "A1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"6", 
         RowBox[{"U", "^", "3"}]}], "+", 
        RowBox[{"18", 
         RowBox[{"U", "^", "2"}]}], "+", 
        RowBox[{"18", "U"}], "+", "5"}], "->", "A2"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"7", 
         RowBox[{"U", "^", "3"}]}], "+", 
        RowBox[{"21", 
         RowBox[{"U", "^", "2"}]}], "+", 
        RowBox[{"18", "U"}], "+", "3"}], "->", "A3"}], ",", 
      RowBox[{
       RowBox[{"A1", "+", 
        RowBox[{"3", "A1", " ", "L"}], "+", 
        RowBox[{"3", " ", "A1", " ", 
         RowBox[{"L", "^", "2"}]}], "+", 
        RowBox[{"A2", " ", 
         RowBox[{"L", "^", "3"}]}]}], "->", "A4"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"L", "^", "3"}]}], "+", 
        RowBox[{"A0", " ", "U"}], "+", 
        RowBox[{"3", " ", "A0", " ", "L", " ", "U"}], "+", 
        RowBox[{"3", " ", "A0", " ", 
         RowBox[{"L", "^", "2"}], " ", "U"}]}], "->", "A5"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"repeat", "=", 
   RowBox[{"{", 
    RowBox[{
    "replacements", ",", "replacements", ",", "replacements", ",", 
     "replacements", ",", "replacements"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Fold", "[", 
    RowBox[{"SubstituteInRules", ",", "LimitSol", ",", "repeat"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TeXForm", "[", "res", "]"}], "\n", 
    RowBox[{"TeXForm", "[", "replacements", "]"}]}], "*)"}]}], "\n", 
 RowBox[{"TeXForm", "[", 
  RowBox[{"C1", "/.", "res"}], "]"}]}], "Input",ExpressionUUID->"4920a8d9-\
56c6-4c49-b322-e897ff1eb944"],

Cell[BoxData[{
 RowBox[{"TeXForm", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"x0", "/.", "Xsol"}], ",", " ", 
         RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
       RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", "Simplify"}], ",",
     " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"x1", "/.", "Xsol"}], ",", " ", 
         RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
       RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", "Simplify"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"x2", "/.", "Xsol"}], ",", " ", 
         RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
       RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", "Simplify"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"x3", "/.", "Xsol"}], ",", " ", 
         RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
       RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", "Simplify"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"x4", "/.", "Xsol"}], ",", " ", 
         RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
       RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", "Simplify"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"x5", "/.", "Xsol"}], ",", " ", 
         RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
       RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", "Simplify"}]}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"s", ",", " ", "L", ",", " ", "U"}], "]"}], ",", " ", 
       RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
     RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", "Simplify"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"s", ",", " ", "L", ",", " ", "U"}], "]"}], ",", " ", 
      RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
    RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"s", ",", " ", "L", ",", " ", "U"}], "]"}], ",", " ", 
      RowBox[{"L", "->", "0"}]}], "]"}], ",", " ", 
    RowBox[{"U", "->", "Infinity"}]}], "]"}], " ", "//", 
  "Simplify"}]}], "Input",ExpressionUUID->"8aaae93c-6e4c-4788-963f-\
795be02fbb78"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9549424363084707`*^9},ExpressionUUID->"2257a816-d932-42f8-8111-\
9daa6d02b135"]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d2c222c9-65f6-4a53-b4f5-31f1d125cc04"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4848, 138, 178, "Input",ExpressionUUID->"b96d007d-ca3e-4d4f-8d4c-fcc6d655c3ce"],
Cell[5409, 160, 5528, 159, 325, "Input",ExpressionUUID->"0c0bc020-0b4e-42e9-a75e-6141ae42bf3c"],
Cell[CellGroupData[{
Cell[10962, 323, 6172, 177, 493, "Input",ExpressionUUID->"c54378ae-061f-4309-9316-8708aa0e0429"],
Cell[17137, 502, 508, 13, 34, "Output",ExpressionUUID->"7c5ab5b5-b399-4256-b504-fd913699efc9"],
Cell[17648, 517, 643, 18, 34, "Output",ExpressionUUID->"afb51589-fc0c-4f3f-b253-d8738be744b0"],
Cell[18294, 537, 502, 13, 34, "Output",ExpressionUUID->"40b26a9a-3611-47d2-ae44-f2ae4df091c6"],
Cell[18799, 552, 603, 18, 34, "Output",ExpressionUUID->"8310c6c4-6fd1-49aa-a4bc-6e8d75a30556"],
Cell[19405, 572, 595, 16, 34, "Output",ExpressionUUID->"73f528ec-64b6-4d30-aa6d-9238501901e3"],
Cell[20003, 590, 612, 15, 34, "Output",ExpressionUUID->"6a147ae4-a92d-4a16-970d-2e0e534fd295"],
Cell[20618, 607, 648, 18, 34, "Output",ExpressionUUID->"523b16a3-9416-486f-b5ad-d06bf7a3fa37"]
}, Open  ]],
Cell[21281, 628, 6120, 168, 388, "Input",ExpressionUUID->"084393d7-ca42-4a4e-a6df-8e5e8d432fa4"],
Cell[27404, 798, 19971, 557, 1396, "Input",ExpressionUUID->"a8ccc721-4392-4d91-9af2-c086aa5d3167"],
Cell[47378, 1357, 1580, 38, 73, "Input",ExpressionUUID->"022e959a-bcb4-4254-af00-15b9e252d901"],
Cell[CellGroupData[{
Cell[48983, 1399, 247, 5, 30, "Input",ExpressionUUID->"f2b00ea5-2f56-44ad-ac23-c58dade251a1"],
Cell[49233, 1406, 393, 11, 34, "Output",ExpressionUUID->"e1ae2b95-82c9-4669-b2ba-65e6a9733251"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49663, 1422, 297, 6, 30, "Input",ExpressionUUID->"154b0aec-2c71-4133-afe3-89f62933496a"],
Cell[49963, 1430, 231, 5, 34, "Output",ExpressionUUID->"6b086d7e-695a-4b56-be9d-6aa0aa9cbc60"]
}, Open  ]],
Cell[50209, 1438, 716, 25, 30, "Input",ExpressionUUID->"f270845f-93e1-4705-9428-990fa1a20382"],
Cell[50928, 1465, 2908, 85, 241, "Input",ExpressionUUID->"4920a8d9-56c6-4c49-b322-e897ff1eb944"],
Cell[53839, 1552, 3048, 89, 199, "Input",ExpressionUUID->"8aaae93c-6e4c-4788-963f-795be02fbb78"],
Cell[56890, 1643, 130, 3, 30, "Input",ExpressionUUID->"2257a816-d932-42f8-8111-9daa6d02b135"]
}
]
*)

